@using PagedList;
@using PagedList.Mvc;
@model IPagedList<WebsiteChungKhoann.Models.Product>
<style>
    .product-item {
        position: relative;
        height: 460px;
    }

        .product-item .overlay {
            display: none; /* Mặc định ẩn */
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(255, 255, 255, 0.4); /* Màu trắng trong suốt với độ mờ 0.4 */
            color: red; /* Màu chữ của thông báo hết hàng */
            font-size: 1.5em;
            font-weight: bold;
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1;
        }

        /* Hiển thị lớp phủ khi sản phẩm hết hàng */
        .product-item.out-of-stock .overlay {
            display: flex;
        }

        .product-item.out-of-stock a {
            pointer-events: none; /* Vô hiệu hóa các liên kết */
        }
</style>
<style>
    .product-item {
        border: 1px solid #ddd;
        border-radius: 5px;
        padding: 2px;
        margin-bottom: 20px;
        background-color: #fff;
    }

    .product-image img {
        width: 100%;
        height: 250px;
        background-size: cover;
        display: block;
        margin-bottom: 15px;
    }

    .product-price {
        font-size: 18px;
        color: #333;
        margin-bottom: 10px;
    }

    .product-name {
        font-size: 16px;
        color: #666;
        margin-bottom: 15px;
    }

    .add-to-cart {
        display: inline-block;
        background-color: #007bff;
        color: #fff;
        padding: 8px 15px;
        border-radius: 5px;
        text-decoration: none;
        transition: background-color 0.3s;
    }

        .add-to-cart:hover {
            background-color: #0056b3;
        }

    .product-price {
        font-size: 18px;
        color: red;
        margin-bottom: 10px;
        display: inline-block;
        transform: skewX(-10deg); /* Nghiêng văn bản */
    }

    .product-item {
        position: relative;
    }

        .product-item.out-of-stock .product-image {
            position: relative;
        }

        .product-item.out-of-stock .overlay {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: rgba(255, 255, 255, 0.7); /* Màu trắng trong suốt khoảng 0.4 */
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 1.5em;
            color: red;
            font-weight: bold;
            z-index: 2;
        }

        .product-item.out-of-stock .btn.disabled {
            pointer-events: none;
            opacity: 0.6;
        }
</style>
@if (Model != null && Model.Any())
{
    foreach (var product in Model)
    {
        if (product.Count > 0)
        {
            <div class="col-sm-10 col-md-10 col-lg-10">
            <div class="product-item">
                <div class="product-image">
                    <img src="@Url.Content(product.Img)" alt="Image" />
                </div>
                <div class="product-name">
                    @Html.DisplayFor(modelItem => product.Name)
                </div>
                <div class="product-price">
                    @Html.DisplayFor(modelItem => product.Price)
                </div>
                <a href="#" class="add-to-cart">Add to Cart</a>
            </div>
            </div>

        }
        else if (product.Count <= 0)
        {
            <div class="product-item" style="display:none">
                <div class="product-image">
                    <img src="@Url.Content(product.Img)" alt="Product Image" />
                </div>
                <div class="product-info">
                    <h3>@product.Name</h3>
                    <p class="product-price">Giá: @product.Price</p>
                    <p class="count">Còn Lại: @product.Count</p>
                    <a href="@Url.Action("Cart", "Cart", new { id = product.Id_Product })" class="btn btn-primary add-to-cart"><i class="fas fa-shopping-cart"></i> Thêm vào giỏ hàng</a>
                    <a href="@Url.Action("Details", "Product", new { id = product.Id_Product })" class="btn btn-secondary">Chi Tiết</a>
                </div>
                <div class="overlay">Hết hàng</div>
            </div>
        }
    }
}
else
{
    <p>Không có sản phẩm nào để hiển thị.</p>
}

<script>
    document.addEventListener('DOMContentLoaded', function () {
        var productItems = document.querySelectorAll('.product-item');

        productItems.forEach(function (item) {
            var countElement = item.querySelector('.count');
            var count = parseInt(countElement.textContent.replace('Còn Lại: ', ''), 10);

            if (count === 0) {
                item.classList.add('out-of-stock');
                item.querySelectorAll('a').forEach(function (link) {
                    link.addEventListener('click', function (e) {
                        e.preventDefault();
                    });
                });
            }
        });
    });

</script>