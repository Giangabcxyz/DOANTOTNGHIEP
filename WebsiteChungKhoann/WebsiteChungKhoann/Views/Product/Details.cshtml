@model WebsiteChungKhoann.Models.Product

@{
    ViewBag.Title = "Details";
    Layout = "~/Views/Shared/_Layout.cshtml";
}
<link href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet">
<!-- Link to Font Awesome -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
<!-- Link to Bootstrap JS -->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.0/umd/popper.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
<style>
    /* Add your custom CSS styles here */
    .rounded-avatar {
        width: 50px;
        height: 50px;
        border-radius: 50%;
    }
    /* Style the comment box and send button */
    .comment-box-wrapper {
        position: relative;
    }

        .comment-box-wrapper textarea {
            border-radius: 20px;
        }

        .comment-box-wrapper .btn-primary {
            position: absolute;
            bottom: 5px;
            right: 10px;
            border-radius: 20px;
        }
    /* Set the width and height for the post image */
    .post-image {
        max-width: 100%;
        height: auto;
    }
    /* Override Bootstrap card header padding */
    .card-text {
        padding: 15px;
    }
    /* Override Bootstrap card body padding */
    .card-body {
        padding: 0;
    }

    .comment {
        display: flex;
    }

    .full-width {
        width: 100%;
    }

    .card-body {
        position: relative;
    }


    .full-width {
        width: 100%;
    }

    .card-body {
        position: relative;
    }

        .card-body .form-control.full-width {
            width: calc(100% - 20px); /* Trừ điều chỉnh margin của textarea */
            margin: 0; /* Không có margin */
        }
</style>
<style>
    /* Custom CSS */
    .video-list {
        height: 100vh;
        overflow-y: auto;
    }

    .video-list-item {
        cursor: pointer;
        padding: 5px;
        border-bottom: 1px solid #ddd;
        display: flex;
        flex-direction: column;
    }

        .video-list-item.selected {
            border: 2px solid red; /* Đổi màu và độ rộng viền tùy ý */
        }

        .video-list-item:hover {
            background-color: #f0f0f0;
        }

    .video-player {
        height: 60vh; /* Giảm kích thước video */
        padding: 0 20px; /* Khoảng cách giữa video và danh sách */
    }

        .video-player iframe {
            width: 100%;
            height: 100%;
            border: none;
        }

    .video-thumbnail {
        max-width: 300px; /* Độ rộng của hình ảnh */
        max-height: 200px; /* Chiều cao tự động */
        margin-right: 10px; /* Khoảng cách giữa hình ảnh và tiêu đề */
        position: absolute;
        width: 100%;
        height: 100%;
        padding: 0;
        margin: 0;
        border-radius: 20px;
        transition: transform 0.8s ease-out;
    }

        .video-thumbnail:hover {
            transform: scale(1.1);
        }

    .comment-section {
        position: relative;
        margin-top: 20px;
    }

    /*.comment {
        margin-bottom: 10px;
        padding: 10px;
        border: 1px solid #ddd;
    }*/
    .video-list {
        display: flex;
        width: 100%;
        padding: 0 5px;
    }

    .item {
        position: relative;
        display: flex;
        padding: 0;
        border-radius: 20px;
        justify-content: space-between;
        /* Màu xám có độ mờ là 0.5 */
    }

    .video-list-item {
        position: absolute;
        width: 95%;
        height: 200px;
        padding: 0;
    }

    .nname, .descriptionn {
        color: black;
        position: absolute;
        top: 105%;
    }

    .descriptionn {
        top: 115%;
    }

        .descriptionn:hover {
            color: red;
            transition: ease-in-out 0.5s;
            transform: 0.5s;
        }

    .nname:hover {
        transition: ease-in-out 0.5s;
        color: red;
        font-size: 18px;
    }
</style>
<style>
    .product-item {
        border: 1px solid #ddd;
        border-radius: 5px;
        padding: 2px;
        margin-bottom: 20px;
        background-color: #fff;
    }

    .product-image img {
        width: 100%;
        height: 280px;
        background-size: cover;
        display: block;
        margin-bottom: 15px;
    }

    .product-price {
        font-size: 18px;
        color: #333;
        margin-bottom: 10px;
    }

    .product-name {
        font-size: 16px;
        color: #666;
        margin-bottom: 15px;
    }

    .add-to-cart {
        display: inline-block;
        background-color: #007bff;
        color: #fff;
        padding: 8px 15px;
        border-radius: 5px;
        text-decoration: none;
        transition: background-color 0.3s;
    }

        .add-to-cart:hover {
            background-color: #0056b3;
        }

    .product-price {
        font-size: 18px;
        color: red;
        margin-bottom: 10px;
        display: inline-block;
        transform: skewX(-10deg); /* Nghiêng văn bản */
    }

    .product-image.sg {
        width: 150px;
        height: 150px;
        position: relative;
    }

        .product-image.sg img {
            position: absolute;
            width: 100%;
            height: 100%;
        }

    .product-info.sg {
        padding: 20px;
    }

    .pr {
        cursor: pointer;
        display: flex;
        margin: 5px 0px;
        background-color: #f0f0f0; /* Màu nền */
        /* Đường viền */
        box-shadow: 5px 5px 10px rgba(0, 0, 0, 0.5);
        border-radius: 20px;
        padding: 5px;
    }

        .pr:hover {
            background-color: rgba(255, 255, 255, 1); /* Màu nền */
        }
</style>
<style>
    /* Add your custom CSS styles here */
    .rounded-avatar {
        width: 50px;
        height: 50px;
        border-radius: 50%;
    }
    /* Style the comment box and send button */
    .comment-box-wrapper {
        position: relative;
    }

        .comment-box-wrapper textarea {
            border-radius: 20px;
        }

        .comment-box-wrapper .btn-primary {
            position: absolute;
            bottom: 5px;
            right: 10px;
            border-radius: 20px;
        }
    /* Set the width and height for the post image */
    .post-image {
        max-width: 100%;
        height: auto;
    }
    /* Override Bootstrap card header padding */
    .card-text {
        padding: 15px;
    }
    /* Override Bootstrap card body padding */
    .card-body {
        padding: 0;
    }

    .comment {
        display: flex;
    }

    .full-width {
        width: 100%;
    }

    .card-body {
        position: relative;
        width: 100%;
    }


    .full-width {
        width: 100%;
    }

    .card-body {
        position: relative;
    }

        .card-body .form-control.full-width {
            width: calc(100% - 20px); /* Trừ điều chỉnh margin của textarea */
            margin: 0; /* Không có margin */
        }

    #commentsContainer {
        position: relative; /* Bắt đầu vị trí tương đối */
        max-height: 300px; /* Chiều cao mặc định của commentsContainer */
        overflow: hidden; /* Ẩn bớt phần nội dung vượt quá max-height */
        transition: max-height 0.8s ease; /* Hiệu ứng chuyển đổi khi thay đổi max-height */
    }

    #showMoreButton {
        position: absolute; /* Thiết lập vị trí tuyệt đối */
        bottom: 0; /* Nằm ở phía dưới */
        right: 0; /* Nằm ở phía bên phải */
        margin: 10px; /* Khoảng cách từ nút đến mép phải và dưới của commentsContainer */
    }



    /* đây là bình luận*/
    .form__textarea {
        width: 100%;
        padding: 10px;
        border: 1px solid #ccc;
        border-radius: 15px;
        resize: vertical; /* Cho phép điều chỉnh chiều cao theo chiều dọc */
        margin-bottom: 10px;
        outline: none;
        margin: 10px;
    }

    .form__btn {
        position: absolute;
        bottom: 15px;
        background-color: #4267B2; /* Màu nền tương tự Facebook */
        color: #fff; /* Màu chữ trắng */
        padding: 10px 20px;
        border: 1px solid #000000;
        border-radius: 5px;
        cursor: pointer;
        transition: background-color 0.3s ease; /* Hiệu ứng chuyển đổi màu nền */
    }

    #cm .form__textarea {
        position: absolute;
        left: 0;
        right: 0;
        background-color: aqua;
        color: red;
    }

    .form__btn:hover {
        background-color: #3B5998; /* Màu nền khi di chuột qua */
    }

    #commentForm {
        position: relative;
    }

    .comment {
        margin: 10px;
    }

        .comment p {
            border-radius: 5px;
            cursor: pointer;
            transition: background-color 0.3s ease;
            padding: 5px 10px;
            margin: 0px 5px;
        }

    .cmt_c {
        position: relative;
    }
</style>
<style>
    .sugget {
        display: flex;
        flex-wrap: wrap; /* Đảm bảo các sản phẩm sẽ xuống hàng nếu không đủ chỗ */
        gap: 15px; /* Khoảng cách giữa các sản phẩm */
    }

    .pr {
        display: flex;
        align-items: center; /* Căn giữa theo trục dọc */
        flex: 1;
        padding: 10px;
        border: 1px solid #ddd;
        border-radius: 5px;
        background-color: #fff;
        box-shadow: 0 2px 5px rgba(0,0,0,0.1);
    }

    .product-image.sg {
        flex: 1;
    }

        .product-image.sg img {
            width: 100px; /* Kích thước hình ảnh */
            height: auto;
            object-fit: cover; /* Đảm bảo hình ảnh không bị méo */
        }

    .product-info.sg {
        flex: 2;
        padding-left: 15px; /* Khoảng cách giữa hình ảnh và thông tin sản phẩm */
    }

        .product-info.sg i {
            font-size: 18px;
            color: red;
        }

        .product-info.sg .product-name.sg {
            font-size: 16px;
            font-weight: bold;
        }

        .product-info.sg a {
            display: block;
            margin-top: 10px;
            color: #007bff;
            text-decoration: none;
        }

            .product-info.sg a:hover {
                text-decoration: underline;
            }

</style>
<div class="container mt-5">
    <div class="row detail_pr">
        <div class="col-sm-6 col-md-4 col-lg-4">
            <div class="product-image">
                <img src="@Url.Content(Model.Img)" alt="Product Image" />
            </div>
        </div>
        <div class="col-sm-6 col-md-8 col-lg-8">
            <div class="product-info">


                <span>@Model.Price</span>

                <p class="product-name">@Model.Name</p>
                <p class="product-description">@Model.Description</p>
                <a href="@Url.Action("Cart", "Cart", new { id = Model.Id_Product })"><i class="btn btn-primary add-to-cart fa fa-shopping-cart">Add to Cart</i></a> |
                <a href="@Url.Action("Buy", "Cart", new { id = Model.Id_Product })">Buy</a>
            </div>
        </div>
    </div>
    <div id="commentForm_@Model.Id_Product">
        @using (Ajax.BeginForm("Create", "Product", new AjaxOptions
        {
            HttpMethod = "Post",
            InsertionMode = InsertionMode.InsertBefore,
            UpdateTargetId = "commentsContainer_" + Model.Id_Product,
            OnBegin = "CheckLogin",
        }, new { @class = "form", id = "commentForm" + Model.Id_Product }))
        {
            <input type="hidden" name="Id_Product" value="@Model.Id_Product" />
            if (Session["Id"] != null)
            {
                <input type="hidden" name="Id_Account" value="@Session["Id"]" />
            }
            <input type="hidden" name="Name" value="@Session["name"]" />

            <div class="cmt_c">

                <textarea class="form__textarea" placeholder="Nhập bình luận" name="Comment"></textarea>
                <button type="submit" class="form__btn">Gửi</button>
            </div>
        }

    </div>

    <!-- Hiển thị bình luận tương ứng -->
    <div class="comment-section">
        <div class="" style="display:none"></div>
        <div id="commentsContainer">
            @foreach (var comment in ViewBag.Comment)
            {
                if (comment.Id_Product == Model.Id_Product)
                {
                    <div class="comment">
                        <img src="https://cdn.icon-icons.com/icons2/11/PNG/256/customer_person_people_man_you_1625.png" class="rounded-avatar mr-2" alt="Avatar">
                        <div class="comment-details">
                            <h6>@comment.AccountName</h6>
                            <p>@comment.Comment</p>
                        </div>
                    </div>
                }

                <!-- Hiển thị các thuộc tính khác của bình luận nếu cần -->
            }
        </div>


    </div>
    <div class="row">
        <p>Gợi ý</p>
    </div>
    <div class="row sugget mt-5">
        @foreach (var i in ViewBag.RelatedProducts)
        {
            <div class="pr d-flex">
                <div class="col-sm-4 col-md-4 col-lg-4">
                    <div class="product-image sg">
                        <img src="@Url.Content(i.Img)" alt="Product Image sg" />
                    </div>
                </div>
                <div class="col-lg-8 col-sm-8 col-md-8">
                    <div class="product-info sg">
                        <i>@i.Price</i>
                        <p class="product-name sg">@i.Name</p>
                        <a href="@Url.Action("Details", "Product", new { id = i.Id_Product })">Chi Tiết</a>
                    </div>
                </div>
            </div>
        }
    </div>

</div>


@functions {
    public string FormatPrice(decimal price)
    {
        return price.ToString("N0") + " đ"; // Định dạng số tiền theo định dạng có dấu chấm phân cách hàng nghìn và thêm đơn vị tiền tệ VND
    }
}
<script>
      function CheckLogin() {
    var ok = '@ViewBag.id.ToString().ToLower()';
      if (ok == "true") {
          alert("Bạn Chưa Đăg nhập");
        window.location.href = '/Account/Login';
        return false;
    } else {
        return true;
    }
}
    document.addEventListener("DOMContentLoaded", function () {
        var commentsContainer = document.getElementById('commentsContainer');

        var showMoreButton = document.createElement('button');
        showMoreButton.innerHTML = '<i class="fa-solid fa-arrow-down"></i>'; // Sử dụng innerHTML để chèn icon vào button
        showMoreButton.id = 'showMoreButton';
        commentsContainer.parentNode.appendChild(showMoreButton);

        var initialHeight = commentsContainer.offsetHeight; // Lưu chiều cao ban đầu của commentsContainer

        showMoreButton.addEventListener('click', function () {
            commentsContainer.classList.toggle('showAllComments');
            if (commentsContainer.classList.contains('showAllComments')) {
                var totalHeight = commentsContainer.scrollHeight;
                commentsContainer.style.maxHeight = totalHeight + 'px';
                showMoreButton.innerHTML = '<i class="fa-solid fa-arrow-up"></i>';
            } else {
                commentsContainer.style.maxHeight = '300px'; // Đặt lại max-height về giá trị mặc định
                showMoreButton.innerHTML = '<i class="fa-solid fa-arrow-down"></i>'; // Sử dụng innerHTML để thay đổi icon
            }
        });
    });

</script>